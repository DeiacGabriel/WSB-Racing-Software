@using WSB_Management.Components.Customs
@using WSB_Management.Components.Layout
@using System.ComponentModel.DataAnnotations
@using WSB_Management.Models
@using Microsoft.AspNetCore.Components.Forms

@page "/management/brands"
@rendermode InteractiveServer
@layout MainLayout

<PageTitle>WSB-Sport - Brands</PageTitle>
<HeadContent>
    <link rel="stylesheet" href="@Assets["brands.css"]" />
</HeadContent>

<div class="group-div">
    <div class="brand-liste-header">
        <p class="brand-titel">Liste aller Marken</p>
    </div>

    <div class="grid-scroll-wrapper">
        <Grid TItem="Brand"
              @ref="grid"
              Class="table table-hover table-bordered table-striped"
              AllowSorting="true"
              AllowFiltering="true"
              AllowSelection="true"
              Responsive="true"
              AllowPaging="false"
              DataProvider="@BrandDataProvider"
              RowKeySelector="b => b.Id"
              SelectionMode="GridSelectionMode.Single"
              Style="height:43rem;"
              SelectedItemsChanged="OnSelectedItemsChanged">

            <GridColumns>
                <GridColumn TItem="Brand" HeaderText="Id" PropertyName="Id" Filterable="false" SortKeySelector="x => x.Id"
                            HeaderStyle="height:2rem;" CellStyle="height:2rem;">
                    @context.Id
                </GridColumn>

                <GridColumn TItem="Brand" HeaderText="Name" PropertyName="Name" SortKeySelector="x => x.Name"
                            HeaderStyle="height:2rem;" CellStyle="height:2rem;">
                    @context.Name
                </GridColumn>

                <GridColumn TItem="Brand" HeaderText="Aktionen" Filterable="false" Sortable="false"
                            HeaderStyle="height:2rem;" CellStyle="height:2rem;">
                    <button class="icon-btn tabel-del-btn"
                            @onclick="() => DeleteBrandAsync(context.Id)"
                            @onclick:stopPropagation="true"
                            title="Löschen">
                        <span class="material-symbols-outlined">delete</span>
                    </button>
                </GridColumn>
            </GridColumns>
        </Grid>
    </div>
</div>

<div id="splitter"></div>

<div class="card details-card">
    <div class="card-header d-flex align-items-center justify-content-between">
        <span class="fw-semibold">Marke bearbeiten</span>
        <Button Color="ButtonColor.Danger" Size="ButtonSize.Small" @onclick="SaveBrand">Speichern</Button>
    </div>

    <div class="card-body" style="padding: 4px;">
        <div class="row g-3 align-items-start">
            <div class="col-md-12">
                <label class="form-label">Markenname</label>
                <input class="form-control" type="text" @bind="CurrentBrand.Name" placeholder="Markenname eingeben" />
            </div>

            @if (!string.IsNullOrWhiteSpace(Message))
            {
                <div class="col-12">
                    <small class="text-muted" style="margin:0;">@Message</small>
                </div>
            }
        </div>
    </div>
</div>
